[Definition]
#
# fail2ban rules for mitigating Zimbra Log4Shell attacks
#
# Author: Marcelo Barreto Nees <marcelo.linux@gmail.com>
# Created at: 2021Dec15
# Updated at: 2021Dec15
#
#
# Bibliographic sources:
#
# - https://wiki.zimbra.com/wiki/Configure_Fail2Ban_for_Zimbra_Server_with_route_instead_of_iptables_to_block_IPs
# - https://dave.moskovitz.co.nz/2021/12/13/mitigating-log4j-log4shell-with-fail2ban/
# - https://stackoverflow.com/questions/70307788/how-to-define-single-regex-to-match-all-log4j-cve-2021-44228-attack-vectors
#

failregex = ^<HOST>:.*jndi:(ldap[s]?|rmi|dns|nis|iiop|corba|nds|http):
            ^<HOST>:.*jndi:
            ^<HOST>:.*(\$|%24)(\{|%7B)([^jJ]*[jJ])([^nN]*[nN])([^dD]*[dD])([^iI]*[iI])(:|%3A|\$|%24|}|%7D)

ignoreregex =
